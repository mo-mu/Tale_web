<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Tale</title>
    <link rel="shortcut icon" type="image/x-icon" href="../img/big_fox_img.ico" />

    <style>
        @font-face {font-family: 'YanoljaYacheRegular'; src: url(../css/fonts/YanoljaYacheRegular.ttf) format('truetype');}
        @font-face {font-family: 'SeoulNamsanCL'; src: url(../css/fonts/SeoulNamsanCL.ttf) format('truetype');}


        html {width: 100%; height: 100%;margin: auto; position: absolute;}
        body {width: 80%; height: 100%; margin: auto; background: #070E20; }
        header{width: 80%; height: 20%; margin: auto; }
        p{width:100%; height:100%;}

        #header{width: 80%; height: 10%; margin: auto; position: relative; z-index: 100;text-align: left;}
        #body{width:100%; height:100%; margin: auto; padding: 20px; position: relative; text-align: center; margin-top: 10%; z-index: 10; }
        #btnMenu{margin-top: 78px; margin-left: 20px; float: left;}
        #divNothing {width:80%; height:100%; margin: auto;  text-align: center; margin-top: 10%; display: none; }
        #imgNothing {margin: auto; width: 20%; height: auto;}
        #txtNothing {color: #FFFFFF; font-family: YanoljaYacheRegular; font-size: 40px; text-align: center; }

        #divNonNthing{width:80%; height:80%; margin: auto;  text-align: center; margin-top: 50px;}

        ul{text-align: center; margin:auto; width:80%; }
        li {color: #FFFFFF; width:800px; text-align: left; margin-bottom: 50px;}

        /* The side navigation menu */
        .sidenav {
            height: 100%; /* 100% Full-height */
            width: 0; /* 0 width - change this with JavaScript */
            position: fixed; /* Stay in place */
            z-index: 1; /* Stay on top */
            left: 0;
            background-color: #111; /* Black*/
            overflow-x: hidden; /* Disable horizontal scroll */
            padding-top: 60px; /* Place content 60px from the top */
            transition: 0.5s; /* 0.5 second transition effect to slide in the sidenav */
        }

        /* The navigation menu links */
        .sidenav a {
            padding: 8px 8px 8px 32px;
            text-decoration: none;
            font-size: 25px;
            color: #818181;
            display: block;
            transition: 0.3s
        }

        /* When you mouse over the navigation links, change their color */
        .sidenav a:hover, .offcanvas a:focus{
            color: #f1f1f1;
        }

        /* Position and style the close button (top right corner) */
        .sidenav .closebtn {
            position: absolute;
            top: 0;
            right: 25px;
            font-size: 36px;
            margin-left: 50px;
        }


        /* Style page content - use this if you want to push the page content to the right when you open the side navigation */
        #main {
            transition: margin-left .5s;
            padding: 20px;
            left: 50%; transform: translateX(-50%);
            position: absolute;
        }

        /* On smaller screens, where height is less than 450px, change the style of the sidenav (less padding and a smaller font size) */
        @media screen and (max-height: 450px) {
            .sidenav {padding-top: 15px;}
            .sidenav a {font-size: 18px;}
        }

    </style>

    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-messaging.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script>
        var config = {
            apiKey: "AIzaSyColbhitRrtw649B0e3dv_FErFd98jX2Rs",
            authDomain: "tale-97db4.firebaseapp.com",
            databaseURL: "https://tale-97db4.firebaseio.com",
            storageBucket: "tale-97db4.appspot.com",
            messagingSenderId: "995377513212"
        };
        firebase.initializeApp(config);

        function getDatas() {
            firebase.auth().onAuthStateChanged(function (user) {
                if(user){    //로그인 돼있을 때
                    var time, question, answer;
                    var lists = firebase.database().ref('Answer/' + user.uid + "");

                    lists.on('child_added', function (data) {
                        if (data) {
                            document.getElementById("divNonNthing").style.display = "block";
                            document.getElementById("divNothing").style.display = "none";
                            question = data.val().question;
                            answer = data.val().answer;
                            time = data.val().created_at;
                            $('#lists').append(' <li><span id="txtTime">'+time+'</span>' +
                                ' <div><h3 id="txtQuestion">'+question+'</h3> <p id="txtAnswer">'+answer+'</p></div></li> <br>');
                        } else {
                            document.getElementById("divNonNthing").style.display = "none";
                            document.getElementById("divNothing").style.display = "block";

                        }
                    });
                    if(lists){
                        document.getElementById("divNonNthing").style.display = "none";
                        document.getElementById("divNothing").style.display = "block";
                    }
                }
                else  {      //로그인 안돼있을 때
                    location.href="Preview.html"  // 페이지 이동
                }
            });

        }

        /* Set the width of the side navigation to 250px */
        function openNav() {
            document.getElementById("mySidenav").style.width = "15%";
        }

        /* Set the width of the side navigation to 0 */
        function closeNav() {
            document.getElementById("mySidenav").style.width = "0";
        }
    </script>
</head>
<body onload="getDatas()">

    <!-- 네비게이션 드로어-->
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>

        <a href="Main.html">글쓰기</a>
        <a href="#" onclick="return false">지난이야기</a>
        <a href="Setup.html">설정</a>
        <a href="Download.html">앱 다운로드</a>
    </div>
    <!-- // 네비게이션 드로어-->

    <div id="main">
        <!--헤더 -->
        <div id="header">
            <img src="../img/menu_btn.png" id="btnMenu" width="50px" height="50px" onclick="openNav()" />
        </div>
        <!-- //헤더-->


        <!-- 바디-->
        <div id="body" >
            <div id = "divNothing">
                <p>
                    <img id = "imgNothing" src="../img/cryingfox_img.png" />
                    <h4 id = "txtNothing" >지난 이야기가 없어요...ㅠㅠ</h4>
                </p>
            </div>
            <div id="divNonNthing">
                <ul class="mylist" id="lists">
                </ul>
            </div>
        </div>
        <!-- //바디-->
    </div>
</body>
</html>
