<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Tale</title>

    <style>
        @font-face {font-family: 'SeoulNamsanCL'; src: url(../css/fonts/SeoulNamsanCL.ttf) format('truetype');}

        html, body {width: 100%; height: 100%; margin: auto 0; background: #070E20;}
        p {color : #ffffff; font-size : 25px; font-family: SeoulNamsanCL;}
        input {width: 430px; height: 60px; border-radius: 30px; margin-bottom: 46px; font-family: SeoulNamsanCL; font-size: 20pt;}

        #nickname{margin-bottom: 70px;}
        #btnSubmit{background: #2bdaaf; border-color: #2bdaaf; border-radius: 30px; width: 286px; height: 56px; font-family: SeoulNamsanCL; font-size: 25pt; color: #FFFFFF;}

        .edit_title{font-size: 17pt; text-align:left;margin-bottom: 16px; margin-top: 46px; margin-left: 20px;}
        .edit{background: #070E20; border-color: #FFFFFF; color:#ffffff; padding-left: 30px;}
        .para{width: 100%; height: 100%; top:0; left:0; text-align:center; position:absolute;}
        .para  .context{display:inline-block;vertical-align:middle; text-align:center;}
        .para .blank{display:inline-block;width:0;height:100%;vertical-align:middle;}
    </style>


    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-messaging.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script>
        // Initialize Firebase
        // TODO: Replace with your project's customized code snippet
        var config = {
            apiKey: "AIzaSyColbhitRrtw649B0e3dv_FErFd98jX2Rs",
            authDomain: "tale-97db4.firebaseapp.com",
            databaseURL: "https://tale-97db4.firebaseio.com",
            storageBucket: "tale-97db4.appspot.com",
            messagingSenderId: "995377513212"
        };
        firebase.initializeApp(config);


        window.onload = function () {
            var btnSubmit = document.getElementById("btnSubmit");
            btnSubmit.addEventListener("click", function () {
                var editEmail = document.getElementById("email");
                var editPassword = document.getElementById("password");
                var editNickname = document.getElementById("nickname");

                const auth = firebase.auth();
                auth.createUserWithEmailAndPassword(editEmail.value, editPassword.value).then(function () {
                    var w;
                    if(typeof(Worker) !== 'undefined') {
                        if(typeof (w) =='undefined'){
                            w = new Worker('../js/SignUpWorker.js');
                            w.postMessage([firebase.auth().currentUser.uid,editEmail.value,editNickname.value]);
                            w.onmessage = function (event) {
                                if(event.data==="finish!!") {
                                    workerEnd();
                                }
                            }
                        } else{
                        }

                    }else{
                        alert("not supported this web browser!!");
                    }
                    function workerEnd() {
                        w.terminate();
                        w = undefined;
                        location.href="Main.html";
                    }
                }).catch(function(error) {
                    // Handle Errors here.
                    var errorCode = error.code;
                    var errorMessage = error.message;
                    isSignUped=false;
                    alert(errorCode +" : "+errorMessage);
                    // ...
                })
           });

        }

    </script>
</head>
<body>
    <div class="para">
        <div class="context">
            <p>아래 정보를 입력하고, 3초 만에 가입하세요.</p>

            <div>
                <p class="edit_title">이메일</p> <input class="edit" type="email" id="email"><br>
                <p class="edit_title">비밀번호</p> <input class="edit" type="password" id="password"><br>
                <p class="edit_title">닉네임</p> <input class="edit" id="nickname" type="text"><br>
                <button id="btnSubmit">회원가입</button>
            </div>

        </div>

        <div class="blank"></div>
    </div>
</body>
</html>
